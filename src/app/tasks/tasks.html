<div class="col-sm-8 col-xs-12">
    <table class="table table-hover">
        <thead>
            <tr>
                <th colspan="2">Task List</th>
                <th><button class="btn btn-primary" (click)="openModal()">Add Task</button></th>
            </tr>
        </thead>
        <tbody>
            <tr *ngFor="let task of tasks" (click)="openModal(task)">
                <td><strong class="text-muted">{{(""+task.description).substring(0,30)}}</strong></td>
                <!-- <p><i class="text-muted">Starts On: {{moment(task.startsOn).format("DD-MMMM-YYYY")}}</i></p> -->
                <!-- <td><i class="text-muted">Next Due Date: {{task.nextDueDate.format("DD-MMMM-YYYY")}}</i></p> -->
                <!-- <td><i class="text-muted">Repeats Every: {{getFrequencyTypeText(task.frequency)}}</i></p> -->
                <td><i class="text-muted">Assigned To: {{task.user && task.user.length>0?task.user[0].name:"**Not Assigned**"}}</i></td>
                <td><i class="text-muted">Customer: {{task.customer && task.customer.length>0? task.customer[0].name:"**Not Assigned**"}}</i></td>
            </tr>
        </tbody>
        <tfoot>
            <tr>
                <td>
                </td>
            </tr>
        </tfoot>
    </table>
</div>

<ng-template #template>
    <div class="modal-header">
        <h4 class="modal-title pull-left">Add Task</h4>
        <button type="button" class="close pull-right" aria-label="Close" (click)="modalRef.hide()">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
    <div class="modal-body">
        <form class="container-fluid well well-default" #taskForm="ngForm">
            <div class="form-group">
                <textarea class="form-control" name="description" required [(ngModel)]="currentTask.description" placeholder="Description"></textarea>
            </div>

            <div class="form-group">
                <label>Starts On <input type="date" class="form-control" name="startDate" required [(ngModel)]="currentTask.startsOn" placeholder="Task Starts On"></label>
            </div>

            <div class="form-group">
                <select class="form-control" name="taskType" required [(ngModel)]="currentTask.type">
                    <option value="undefined" disabled>Select Task Type</option>
                    <option [ngValue]="type.value" *ngFor="let type of taskTypes">{{type.text}}</option>
                </select>
            </div>
            <label>Select User
            <input name="user"
            (typeaheadOnSelect)="currentTask.user = [$event.item]"
            [(ngModel)]="currentTask.userName"
            placeholder="Assign Task To"
            typeaheadOptionField="name"
            [typeahead]="users"
            class="form-control">
            </label>

            <label>Select Customer
            <input name="customer" 
            (typeaheadOnSelect)="currentTask.customer = [$event.item]"
            [(ngModel)]="currentTask.customerName"
            placeholder="Select Customer"
            [typeahead]="customers"
            typeaheadOptionField="name_mobile"
            class="form-control">
            </label>


            <div class="form-group">
                <button [disabled]="!taskForm.valid" (click)="createOrUpdateTask(currentTask)" class="btn btn-primary">
                    {{currentTask.id?'Update':'Save'}}
                </button>
                <button [disabled]="!currentTask.id" (click)="deleteTask(currentTask)" class="btn btn-danger">Delete</button>
                <button (click)="reset()" class="btn btn-default">Reset</button>



            </div>
        </form>
    </div>

</ng-template>